# 门店管理系统 - 使用指南

本项目包含三个独立的系统，分别用于不同的业务场景。

---

## 📋 系统概览

| 系统 | 用途 | 使用场景 | 访问方式 |
|------|------|----------|----------|
| **周清审核系统** | 运营人员审核门店检查项图片 | 本地局域网 | http://localhost:5001 |
| **审核结果展示系统** | 展示和管理审核结果 | 云服务器 | http://blitzepanda.top |
| **门店评级系统** | 区域经理对门店评级 | 云服务器 | http://blitzepanda.top/rating |

---

## 1️⃣ 周清审核系统（本地使用）

### 功能说明
- 展示门店检查项的三张图片（标准图、现场图1、现场图2）
- 运营人员在局域网内对每个检查项进行审核（合格/不合格）
- 可以添加问题描述
- 支持按运营人员筛选
- 导出审核结果为CSV

### 使用流程

#### 第一步：准备数据文件
准备包含以下列的Excel文件：
- 门店编号
- 门店名称
- 所属区域
- 检查项名称
- 标准图（图片URL）
- 现场图1（图片URL）
- 现场图2（图片URL）
- 运营人员

#### 第二步：启动系统
```bash
python app.py
```

系统会自动：
- 启动在 http://localhost:5001
- 初始化数据库
- 加载白名单数据

#### 第三步：上传Excel文件
1. 打开浏览器访问 http://localhost:5001
2. 点击页面上的"上传Excel"按钮
3. 选择准备好的Excel文件
4. 等待上传完成

#### 第四步：开始审核
1. 选择运营人员（可选）
2. 查看门店检查项图片
3. 点击"合格"或"不合格"按钮
4. 如果不合格，填写问题描述
5. 使用键盘快捷键提高效率：
   - `←` `→` 切换检查项
   - `Enter` 标记合格
   - `Space` 标记不合格

#### 第五步：导出结果
1. 审核完成后，点击"导出CSV"按钮
2. 下载审核结果文件
3. 文件包含所有审核记录

### 新周期操作
当新的周清周期开始时：
1. 准备新周期的Excel文件
2. 重新启动系统：`python app.py`
3. 上传新的Excel文件
4. 开始新一轮审核

**注意**：每次上传新文件会覆盖之前的数据，建议先导出旧数据再上传新文件。

### 常见问题

**Q: 图片显示不出来？**
A: 检查Excel中的图片URL是否可访问，确保网络连接正常。

**Q: 如何查看某个运营人员的审核进度？**
A: 使用页面上的运营人员筛选下拉菜单。

**Q: 可以修改已审核的结果吗？**
A: 可以，重新点击合格/不合格按钮即可覆盖之前的结果。

---

## 2️⃣ 审核结果展示系统（云服务器）

### 功能说明
- 展示所有门店的审核结果
- 支持按战区、省份、城市、运营人员筛选
- 显示审核统计信息
- 管理白名单和审核结果数据

### 使用流程

#### 访问系统
浏览器打开：http://blitzepanda.top

#### 查看审核结果
1. 使用筛选条件查找特定门店
2. 查看每个门店的检查项审核情况
3. 查看不合格项的问题描述

#### 管理数据（管理员）
访问管理页面：http://blitzepanda.top/admin

**上传白名单：**
1. 准备白名单Excel文件（包含门店基本信息）
2. 点击"选择白名单文件"
3. 点击"上传白名单"
4. 等待导入完成

**上传审核结果：**
1. 从周清审核系统导出CSV文件
2. 点击"选择审核结果文件"
3. 点击"上传审核结果"
4. 系统会自动匹配白名单数据

### 数据更新流程
```
周清审核系统（本地）
    ↓ 导出CSV
审核结果文件
    ↓ 上传到管理页面
审核结果展示系统（云端）
```

---

## 3️⃣ 门店评级系统（云服务器）

### 功能说明
- 区域经理对门店进行A/B/C评级
- 支持按战区、区域经理筛选
- 显示门店堂食营业额
- 实时保存评级结果
- 导出评级结果为CSV

### 评级标准
- **A类门店**：装修、客流量、服务意识、配合度、堂食营业额都优秀
- **B类门店**：装修、服务意识、配合度良好，堂食营业额有较高提升空间
- **C类门店**：某方面存在硬伤，较难提升

### 使用流程

#### 第一步：访问系统
浏览器打开：http://blitzepanda.top/rating

#### 第二步：筛选门店
1. 选择战区（可选）
2. 选择区域经理（可选）
3. 点击"搜索"按钮

#### 第三步：评级
1. 查看门店信息和堂食营业额
2. 根据评级标准点击 A、B 或 C 按钮
3. 系统自动保存评级结果
4. 使用分页查看更多门店

#### 第四步：导出结果
1. 点击右上角"导出"按钮
2. 下载包含所有评级的CSV文件

### 特点
- ✅ 自动保存，无需手动提交
- ✅ 支持修改已评级的门店
- ✅ 显示各战区评级完成率
- ✅ 移动端友好，可在手机上使用

---

## 🔧 技术人员参考

### 系统架构

```
项目根目录/
├── app.py                      # 周清审核系统（本地）
├── viewer/app_viewer.py        # 审核结果展示系统（云端）
├── rating_app.py               # 门店评级系统（云端）
├── templates/                  # 周清审核系统模板
├── viewer/templates/           # 展示和评级系统模板
├── static/                     # 周清审核系统静态文件
└── viewer/static/              # 展示和评级系统静态文件
```

### 端口分配
- 周清审核系统：5001（本地）
- 审核结果展示系统：5001（云端）
- 门店评级系统：8001（云端）

### 数据库
- 周清审核系统：PostgreSQL（本地）
- 审核结果展示系统：PostgreSQL（云端）
- 门店评级系统：JSON文件（无需数据库）

### 部署文档
- 门店评级系统部署：`deploy/rating_deploy_guide.md`
- 服务器快速部署：`服务器快速部署.md`
- Nginx配置：`deploy/nginx_config_guide.md`

---

## 📞 支持

如有问题，请联系技术支持。

### 常用命令速查

**周清审核系统：**
```bash
python app.py                    # 启动系统
```

**审核结果展示系统：**
```bash
python viewer/app_viewer.py      # 启动系统
python reload_whitelist.py       # 重新加载白名单
```

**门店评级系统：**
```bash
python rating_app.py             # 启动系统
python export_stores_to_json.py  # 导出门店数据
```

**服务器部署：**
```bash
systemctl status rating          # 查看评级系统状态
systemctl restart rating         # 重启评级系统
tail -f logs/rating_app.log      # 查看日志
```
