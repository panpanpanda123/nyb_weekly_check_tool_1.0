<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>门店检查项图片审核系统</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>🏪 门店检查项图片审核系统</h1>
            <div class="header-info">
                <div class="filter-section">
                    <label for="operatorFilter">👤 运营人员:</label>
                    <select id="operatorFilter" class="operator-filter">
                        <option value="全部">全部</option>
                    </select>
                </div>
                <div class="search-section">
                    <label for="storeSearch">🔍 搜索门店:</label>
                    <input type="text" id="storeSearch" class="store-search" placeholder="输入完整的门店编号或名称">
                    <button id="searchBtn" class="search-btn">搜索</button>
                    <button id="clearSearchBtn" class="clear-search-btn" style="display:none;">✕ 清除</button>
                </div>
                <span id="totalCount" class="count-badge">总计: 0</span>
                <span id="reviewedCount" class="count-badge">已审核: 0</span>
            </div>
            
            <!-- 视图切换标签 -->
            <div class="view-tabs">
                <button id="pendingTab" class="tab-btn active">📝 待审核 (每页10家店)</button>
                <button id="completedTab" class="tab-btn">✓ 已完成列表</button>
            </div>
            
            <!-- 统计面板（所有运营人员可见） -->
            <div id="statsPanel" class="stats-panel" style="display:none;">
                <div class="stats-header">
                    <h3>📊 <span id="operatorName"></span> 的审核进度</h3>
                </div>
                <div class="stats-grid">
                    <div class="stat-box">
                        <div class="stat-label">全量进度</div>
                        <div class="stat-value" id="allProgress">0/0</div>
                        <div class="stat-percent" id="allPercent">0%</div>
                    </div>
                    <div class="stat-box personal">
                        <div class="stat-label">个人进度</div>
                        <div class="stat-value" id="personalProgress">0/0</div>
                        <div class="stat-percent" id="personalPercent">0%</div>
                    </div>
                </div>
            </div>
            
            <!-- 管理员面板（仅"窦"可见） -->
            <div id="adminPanel" class="admin-panel" style="display:none;">
                <div class="admin-header">
                    <h3>🔧 管理员工具</h3>
                </div>
                <div class="admin-actions">
                    <button id="exportBtn" class="admin-btn export-btn">📥 导出当前数据</button>
                    <label for="uploadFile" class="admin-btn upload-btn">📤 上传新Excel（开始新周期）</label>
                    <input type="file" id="uploadFile" accept=".xlsx" style="display:none;">
                </div>
            </div>
        </header>
        
        <main id="itemsContainer">
            <!-- 检查项卡片将动态加载到这里 -->
            <div class="loading">
                <div class="spinner"></div>
                <p>正在加载检查项数据...</p>
            </div>
        </main>
        
        <div id="toast" class="toast"></div>
        
        <!-- 键盘操作说明 -->
        <div class="keyboard-help">
            <div class="help-title">⌨️ 键盘快捷操作</div>
            <div class="help-item"><kbd>←</kbd> <kbd>→</kbd> 切换检查项</div>
            <div class="help-item"><kbd>Enter</kbd> 标记合格</div>
            <div class="help-item"><kbd>Space</kbd> 标记不合格</div>
            <div class="help-hint">💡 标记不合格后输入理由，按回车确认</div>
        </div>
    </div>
    
    <!-- 图片查看器模态框 -->
    <div id="imageModal" class="image-modal" onclick="closeImageModal()">
        <span class="modal-close">&times;</span>
        <img class="modal-content" id="modalImage" onclick="event.stopPropagation()">
        <div class="modal-caption" id="modalCaption"></div>
    </div>
    
    <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>
