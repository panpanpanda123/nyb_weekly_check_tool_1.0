# å¿«é€Ÿéƒ¨ç½²å‚è€ƒå¡ç‰‡

## ğŸš€ 5åˆ†é’Ÿå¿«é€Ÿå¼€å§‹

### æœ¬åœ°å‡†å¤‡
```bash
# 1. è¿è¡Œè¿ç§»è„šæœ¬
python migrate_to_cloud.py

# 2. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
nano .env  # ä¿®æ”¹æ•°æ®åº“å¯†ç å’Œè·¯å¾„
```

### äº‘æœåŠ¡å™¨éƒ¨ç½²
```bash
# 1. ä¸Šä¼ æ–‡ä»¶
scp -r ./* user@server:/var/www/inspection_system/

# 2. SSHè¿æ¥
ssh user@server
cd /var/www/inspection_system

# 3. å®‰è£…ä¾èµ–
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# 4. é…ç½®ç¯å¢ƒ
cp .env.example .env
nano .env  # ä¿®æ”¹é…ç½®

# 5. åˆå§‹åŒ–æ•°æ®åº“
python init_database.py

# 6. å¯åŠ¨æœåŠ¡
chmod +x start_server.sh
./start_server.sh
```

---

## ğŸ“ å¿…é¡»ä¿®æ”¹çš„3ä¸ªåœ°æ–¹

### 1. æ•°æ®åº“å¯†ç ï¼ˆ.envï¼‰
```bash
DATABASE_URL=postgresql://inspection_user:æ”¹æˆå¼ºå¯†ç @localhost:5432/configurable_ops
```

### 2. æ–‡ä»¶è·¯å¾„ï¼ˆ.envï¼‰
```bash
WHITELIST_FILE=/var/www/inspection_system/data/whitelist.xlsx
```

### 3. å®‰å…¨å¯†é’¥ï¼ˆ.envï¼‰
```bash
SECRET_KEY=è¿è¡Œå‘½ä»¤ç”Ÿæˆéšæœºå¯†é’¥
```

ç”Ÿæˆå¯†é’¥:
```bash
python3 -c "import secrets; print(secrets.token_hex(32))"
```

---

## ğŸ”§ å…³é”®å‘½ä»¤

### æœåŠ¡ç®¡ç†
```bash
# å¯åŠ¨
sudo systemctl start inspection

# åœæ­¢
sudo systemctl stop inspection

# é‡å¯
sudo systemctl restart inspection

# æŸ¥çœ‹çŠ¶æ€
sudo systemctl status inspection

# æŸ¥çœ‹æ—¥å¿—
sudo journalctl -u inspection -f
```

### æ—¥å¿—æŸ¥çœ‹
```bash
# åº”ç”¨æ—¥å¿—
tail -f logs/app.log

# é”™è¯¯æ—¥å¿—
tail -f logs/error.log

# Nginxæ—¥å¿—
tail -f /var/log/nginx/error.log
```

### æ•°æ®åº“æ“ä½œ
```bash
# è¿æ¥æ•°æ®åº“
psql -U inspection_user -d configurable_ops

# å¤‡ä»½æ•°æ®åº“
pg_dump -U inspection_user configurable_ops > backup.sql

# æ¢å¤æ•°æ®åº“
psql -U inspection_user configurable_ops < backup.sql
```

---

## âš ï¸ å¸¸è§é”™è¯¯

| é”™è¯¯ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|------|----------|
| æ•°æ®åº“è¿æ¥å¤±è´¥ | å¯†ç é”™è¯¯æˆ–PostgreSQLæœªå¯åŠ¨ | æ£€æŸ¥.envé…ç½®ï¼Œå¯åŠ¨PostgreSQL |
| ç™½åå•æ–‡ä»¶æ‰¾ä¸åˆ° | è·¯å¾„é”™è¯¯ | æ£€æŸ¥WHITELIST_FILEè·¯å¾„ |
| ç«¯å£è¢«å ç”¨ | 5001ç«¯å£å·²è¢«ä½¿ç”¨ | ä¿®æ”¹.envä¸­çš„PORT |
| æƒé™ä¸è¶³ | æ–‡ä»¶æƒé™é—®é¢˜ | è¿è¡Œchmodå’Œchownå‘½ä»¤ |

---

## ğŸ“‚ é‡è¦æ–‡ä»¶ä½ç½®

```
/var/www/inspection_system/
â”œâ”€â”€ .env                    # ç¯å¢ƒé…ç½®ï¼ˆå¿…é¡»ä¿®æ”¹ï¼‰
â”œâ”€â”€ app_cloud.py           # åº”ç”¨ä¸»æ–‡ä»¶
â”œâ”€â”€ data/whitelist.xlsx    # ç™½åå•ï¼ˆå¿…é¡»ä¸Šä¼ ï¼‰
â”œâ”€â”€ logs/app.log           # åº”ç”¨æ—¥å¿—
â””â”€â”€ æ£€æŸ¥é¡¹è®°å½•.xlsx         # æ£€æŸ¥é¡¹æ•°æ®
```

---

## âœ… éƒ¨ç½²æ£€æŸ¥æ¸…å•

- [ ] Python 3.8+ å·²å®‰è£…
- [ ] PostgreSQL å·²å®‰è£…å¹¶è¿è¡Œ
- [ ] é¡¹ç›®æ–‡ä»¶å·²ä¸Šä¼ 
- [ ] .env æ–‡ä»¶å·²é…ç½®
- [ ] ç™½åå•æ–‡ä»¶å·²ä¸Šä¼ åˆ°data/ç›®å½•
- [ ] æ•°æ®åº“å·²åˆå§‹åŒ–
- [ ] åº”ç”¨å¯ä»¥å¯åŠ¨
- [ ] ç½‘é¡µå¯ä»¥è®¿é—®
- [ ] å®¡æ ¸åŠŸèƒ½æ­£å¸¸
- [ ] CSVå¯¼å‡ºæ­£å¸¸

---

## ğŸ†˜ ç´§æ€¥æ•‘æ´

### å®Œå…¨é‡ç½®
```bash
# 1. åœæ­¢æœåŠ¡
sudo systemctl stop inspection

# 2. æ¸…ç©ºæ•°æ®åº“
psql -U postgres -c "DROP DATABASE configurable_ops;"
psql -U postgres -c "CREATE DATABASE configurable_ops;"

# 3. é‡æ–°åˆå§‹åŒ–
cd /var/www/inspection_system
source venv/bin/activate
python init_database.py

# 4. é‡å¯æœåŠ¡
sudo systemctl start inspection
```

### æŸ¥çœ‹å®Œæ•´é”™è¯¯
```bash
# æŸ¥çœ‹æœ€è¿‘100è¡Œæ—¥å¿—
sudo journalctl -u inspection -n 100

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
sudo journalctl -u inspection -f

# æŸ¥çœ‹åº”ç”¨é”™è¯¯
tail -n 100 logs/error.log
```

---

## ğŸ“ è·å–æ›´å¤šå¸®åŠ©

- è¯¦ç»†éƒ¨ç½²æ­¥éª¤: `äº‘æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—.md`
- ä»£ç ä¿®æ”¹è¯´æ˜: `ä»£ç ä¿®æ”¹æ¸…å•.md`
- å®Œæ•´æ€»ç»“: `äº‘æœåŠ¡å™¨éƒ¨ç½²æ€»ç»“.md`
